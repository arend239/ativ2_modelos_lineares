---
title: Modelos Lineares
author:
output:
  html_document:
    toc: true
    toc_float:
        collapsed: true
        smooth_scroll: true
    toc_depth: 3
    code_folding: show
    theme: flatly
    code_download: true
fontsize: 14pt
---

Autores: João Vitor da Silva Arend - 00577787

## Instruções
### Simulação Monte Carlo dos Betas do Modelo de Regressão

1. Faça uma simulação de tamanho n (25, 50, 100, 500, 1000) do modelo linear $Y= \beta_0 + \beta_1X + \epsilon$
2. Adicione um outlier nesse banco de dados
3. Estime os $\beta_0$, $\beta_1$ e $S^2$, calcule as estatísticas de teste e os seus respectivos p-valores
4. Guarde esses valores
5. Repita esse esperimento 1000 vezes, isto é, faça uma simulação de monte carlo
6. Faça um histograma e calcule a média, a variância e a mediana dos itens do passo 3
7. Qual a sua conclusão?
8. Entregue o codigo Rmarkdown e o html da tarefa

## Resolução

```{r warning=FALSE, include=FALSE}

library(tidyverse)
set.seed(30102024)
```

```{r}

lines <- function(n, beta0, beta1, e_var) {

  x          <- runif(n, -3, 3)
  epsilon    <- rnorm(n, 0, sqrt(e_var))
  y          <- beta0 + (beta1 * x) + epsilon

  modelo     <- lm(y ~ x)
  beta_0_hat <- modelo$coefficients[[2]]
  beta_1_hat <- modelo$coefficients[[1]]

  sigma2_hat <- sum(modelo$residuals^2) / (n - 1)

  list(x = x,
       y = y,
       beta_0_hat = beta_0_hat,
       beta_1_hat = beta_1_hat,
       sigma2_hat = sigma2_hat)
}

```

Monte Carlo

```{r}

n     <- 50
beta0 <- 2
beta1 <- 3
e_var <- 4

samples = 1:1000 %>%
  map(function(x) lines(n, beta0, beta1, e_var))

list_beta0 <- map(samples, ~ unlist(.[3])) %>%
  map_dbl("beta_0_hat")
list_beta1 <- map(samples, ~ unlist(.[4])) %>%
  map_dbl("beta_1_hat")
list_sigm2 <- map(samples, ~ unlist(.[5])) %>%
  map_dbl("sigma2_hat")

betas_estim <- data.frame(beta_0_hat_mc = c(list_beta0),
                          beta_1_hat_mc = c(list_beta1),
                          sigm2_mc      = c(list_sigm2))
```


